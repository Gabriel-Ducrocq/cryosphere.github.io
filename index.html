<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <!-- Meta tags for social media banners, these should be filled in appropriatly as they are your "business card" -->
  <!-- Replace the content tag with appropriate information -->
  <meta name="description" content="DESCRIPTION META TAG">
  <meta property="og:title" content="SOCIAL MEDIA TITLE TAG"/>
  <meta property="og:description" content="SOCIAL MEDIA DESCRIPTION TAG TAG"/>
  <meta property="og:url" content="URL OF THE WEBSITE"/>
  <!-- Path to banner image, should be in the path listed below. Optimal dimenssions are 1200X630-->
  <meta property="og:image" content="static/image/your_banner_image.png" />
  <meta property="og:image:width" content="1200"/>
  <meta property="og:image:height" content="630"/>


  <meta name="twitter:title" content="TWITTER BANNER TITLE META TAG">
  <meta name="twitter:description" content="TWITTER BANNER DESCRIPTION META TAG">
  <!-- Path to banner image, should be in the path listed below. Optimal dimenssions are 1200X600-->
  <meta name="twitter:image" content="static/images/your_twitter_banner_image.png">
  <meta name="twitter:card" content="summary_large_image">
  <!-- Keywords for your paper to be indexed by-->
  <meta name="keywords" content="KEYWORDS SHOULD BE PLACED HERE">
  <meta name="viewport" content="width=device-width, initial-scale=1">


  <title>Academic Project Page</title>
  <link rel="icon" type="image/x-icon" href="static/images/favicon.ico">
  <link href="https://fonts.googleapis.com/css?family=Google+Sans|Noto+Sans|Castoro"
  rel="stylesheet">

  <link rel="stylesheet" href="static/css/bulma.min.css">
  <link rel="stylesheet" href="static/css/bulma-carousel.min.css">
  <link rel="stylesheet" href="static/css/bulma-slider.min.css">
  <link rel="stylesheet" href="static/css/fontawesome.all.min.css">
  <link rel="stylesheet"
  href="https://cdn.jsdelivr.net/gh/jpswalsh/academicons@1/css/academicons.min.css">
  <link rel="stylesheet" href="static/css/index.css">

  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
  <script src="https://documentcloud.adobe.com/view-sdk/main.js"></script>
  <script defer src="static/js/fontawesome.all.min.js"></script>
  <script src="static/js/bulma-carousel.min.js"></script>
  <script src="static/js/bulma-slider.min.js"></script>
  <script src="static/js/index.js"></script>
</head>
<body>


  <section class="hero">
    <div class="hero-body">
      <div class="container is-max-desktop">
        <div class="columns is-centered">
          <div class="column has-text-centered">
            <h1 class="title is-1 publication-title">CryoSPHERE: bridging the gap between AlphaFold and cryoEM images.</h1>
            <div class="is-size-5 publication-authors">
              <!-- Paper authors -->
              <span class="author-block">
                <a href="https://scholar.google.com/citations?user=ziOaw0cAAAAJ&hl=en" target="_blank">Gabriel Ducrocq</a><sup>1</sup>,</span>
                <span class="author-block">

                  <a href="https://www.uu.se/kontakt-och-organisation/personal?query=N23-705" target="_blank">Lukas Grunewald</a><sup>2</sup>,</span>
                  <span class="author-block">
                    <a href="https://lindsten.netlify.app/" target="_blank">Fredrik Lindsten</a><sup>1</sup>,</span>
                  <span class="author-block">
                    <a href="https://www.uu.se/en/contact-and-organisation/staff?query=N16-2170" target="_blank">Sebastian Westenhoff</a><sup>2</sup>.</span>
                  </span>
                  </div>

                  <div class="is-size-5 publication-authors">
                    <span class="author-block"><small><br><sup>1</sup>Linköping University, <sup>2</sup>Uppsala University<br>ICLR 2025</span>
                  </div>

                  <div class="column has-text-centered">
                    <div class="publication-links">
                         <!-- Arxiv PDF link -->
                      <span class="link-block">
                        <a href="static/pdfs/cryoSPHEREICLR.pdf" target="_blank"
                        class="external-link button is-normal is-rounded is-dark">
                        <span class="icon">
                          <i class="fas fa-file-pdf"></i>
                        </span>
                        <span>Paper</span>
                      </a>
                    </span>

                    <!-- Supplementary PDF link -->
                    <span class="link-block">
                      <a href="https://openreview.net/attachment?id=n8O0trhost&name=supplementary_material" target="_blank"
                      class="external-link button is-normal is-rounded is-dark">
                      <span class="icon">
                        <i class="fas fa-file-pdf"></i>
                      </span>
                      <span>Supplementary</span>
                    </a>
                  </span>

                  <!-- Github link -->
                  <span class="link-block">
                    <a href="https://github.com/Gabriel-Ducrocq/cryoSPHERE" target="_blank"
                    class="external-link button is-normal is-rounded is-dark">
                    <span class="icon">
                      <i class="fab fa-github"></i>
                    </span>
                    <span>Code</span>
                  </a>
                </span>

                <!-- ArXiv abstract Link -->
                <span class="link-block">
                  <a href="https://openreview.net/group?id=ICLR.cc/2025/Conference#tab-active-submissions" target="_blank"
                  class="external-link button is-normal is-rounded is-dark">
                  <span class="icon">
                    <i class="ai ai-arxiv"></i>
                  </span>
                  <span>arXiv</span>
                </a>
              </span>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</section>


<!-- Teaser video-->
<section class="hero teaser">
  <div class="container is-max-desktop">
    <div class="hero-body">
      <video poster="" id="tree" autoplay controls muted loop height="100%">
        <!-- Your video here -->
        <source src="https://www.youtube.com/embed/nhgQU6cEPwI"
        type="video/mp4">
      </video>
      <h2 class="subtitle has-text-centered">
        Aliquam vitae elit ullamcorper tellus egestas pellentesque. Ut lacus tellus, maximus vel lectus at, placerat pretium mi. Maecenas dignissim tincidunt vestibulum. Sed consequat hendrerit nisl ut maximus. 
      </h2>
    </div>
  </div>
</section>
<!-- End teaser video -->

<!-- Youtube video -->
<section class="hero is-small is-light">
  <div class="hero-body">
    <div class="container">
      <!-- Paper video. -->
      <h2 class="title is-3">Video Presentation</h2>
      <div class="columns is-centered has-text-centered">
        <div class="column is-four-fifths">
          
          <div class="publication-video">
            <!-- Youtube embed code here -->
            <iframe src="https://www.youtube.com/embed/nhgQU6cEPwI" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe>
          </div>
        </div>
      </div>
    </div>
  </div>
</section>
<!-- End youtube video -->


<!-- Paper abstract -->
<section class="section hero is-light">
  <div class="container is-max-desktop">
    <div class="columns is-centered has-text-centered">
      <div class="column is-four-fifths">
        <h2 class="title is-3">Abstract</h2>
        <div class="content has-text-justified">
          <p>
          The three-dimensional structure of proteins plays a crucial role in determining their function. Protein structure prediction methods, like AlphaFold, offer rapid access to a protein’s structure. However, large protein complexes cannot be reliably predicted, and proteins are dynamic, making it important to resolve their full conformational distribution. Single-particle cryo-electron microscopy (cryo-EM) is a powerful tool for determining the structures of large protein complexes. Importantly, the numerous images of a given protein contain underutilized information about conformational heterogeneity. These images are very noisy projections of the protein, and traditional methods for cryo-EM reconstruction are limited to recovering only one or a few consensus conformations.

          In this paper, we introduce cryoSPHERE, which is a deep learning method that uses a nominal protein structure (e.g., from AlphaFold) as input, learns how to divide it into segments, and moves these segments as approximately rigid bodies to fit the different conformations present in the cryo-EM dataset. This approach provides enough constraints to enable meaningful reconstructions of single protein structural ensembles. We demonstrate this with two synthetic datasets featuring varying levels of noise, as well as one real dataset. We show that cryoSPHERE is very resilient to the high levels of noise typically encountered in experiments, where we see consistent improvements over the current state-of-the-art for heterogeneous reconstruction.
          </p>
        </div>
      </div>
    </div>
  </div>
</section>
<!-- End paper abstract -->



<!-- CryoEM description -->
<section class="section hero is-light">
  <div class="container is-max-desktop">
    <div class="columns is-centered has-text-centered">
      <div class="column is-four-fifths">
        <h2 class="title is-3">What is cryoEM ?</h2>
        <div class="content has-text-justified">
        <div id="results-carousel" class="carousel results-carousel">
       <div class="item">
        <!-- Your image here -->
        <img src="static/images/cryoEMAcquisition.jpeg" alt="MY ALT TEXT" height="10" />
        <h2 class="subtitle has-text-centered">
          Results on a toy datasets:
        </h2>
      </div>
      <div class="item">
        <!-- Your image here -->
        <img src="static/images/micrographResized.png" alt="MY ALT TEXT"/>
        <h2 class="subtitle has-text-centered">
          Example of micrograph obtained after using the cryogenic electron microscope.
        </h2>
      </div>
      <div class="item">
        <!-- Your image here -->
        <img src="static/images/exampleImage.png" alt="MY ALT TEXT"/>
        <h2 class="subtitle has-text-centered">
          Example of image extracted from the micrograph.
        </h2>
      </div>
  </div>
      <div>
          <span>
          Single-particle cryo-electron microscopy (cryo-EM) is a powerful technique for determining the three-dimensional structure of biological macromolecules, including proteins. In a cryo-EM experiment, millions of copies of the same protein are first frozen in a thin layer of vitreous ice and then
          imaged using an electron microscope. This yields a micrograph: a noisy image containing 2D projections of individual proteins. The protein projections are then located on this micrograph and cut
          out so that an experiment typically yields ten thousands to ten millions images of individual proteins, referred to as particles. Our goal is to reconstruct the possible structures (called conformations) of the proteins given these images. Frequently, proteins are conformationally heterogeneous and each copy represents a different structure. Conventionally, this information has been discarded, and all of the sampled structures were assumed to be in only one or a few conformations (homogeneous reconstruction). Here, we would like to recover all of the structures in a heterogeneous reconstruction. There are a number of challenges:
          <ul>
              <li>The signal-to-noise ratio is low, typically 0.01 or lower.</li>
              <li>The pose of the protein on a given image is unknown.</li>
              <li>The protein might have different conformations on different images.</li>
          </ul>
          </span>
      </div>
    </div>
      </div>
    </div>
  </div>
</section>
<!-- End CryoEM description -->



<!-- cryoSPHERE motivation -->
<section class="section hero is-light">
  <div class="container is-max-desktop">
    <div class="columns is-centered has-text-centered">
      <div class="column is-four-fifths">
        <h2 class="title is-3">Why cryoSPHERE ?</h2>
        <div class="content has-text-justified">
          <p>
          Traditional methods reconstruct a volume of the protein, typically in Fourier space. Framing the problem this way has two shortcomings that makes this method susceptible to the low SNR:
           <ul>
              <li>It disregards prior information about the protein: we may already have a good idea of its structure, obtained through previous experiments such as Xray crytallography or using AlphaFold.</li>
              <li>The motion of the protein is restricted by the laws of physics. Using such constraints is difficult for volume methods.</li>
          </ul>
          To remedy this, we root our method in the observation that different conformations can often be
          explained by large scale movements of domains of the protein. Specifically, we
          develop a variational auto-encoder (VAE) that, from a nominal structure
          and a set of cryo-EM images:
          <ul>
          <li> Learns how to divide the amino-acid chain into segments, given a user defined maximum number of segments. The nominal structure can for instance be obtained by AlphaFold. </li>
          <li> For each image, learns approximately rigid transformations of the identified segments of the nominal structure, which effectively allows us to recover different conformations on an image-by-image basis. </li>
          </ul>
            These two steps happen concurrently, and the model is end-to-end differentiable.
          </p>
        </div>
      </div>
    </div>
  </div>
</section>
<!-- End cryoSPHERE motivation -->


<!-- how does cryoSPHERE works ?-->
<section class="section hero is-light">
  <div class="container is-max-desktop">
    <div class="columns is-centered has-text-centered">
      <div class="column is-four-fifths">
        <h2 class="title is-3"> How does cryoSPHERE works ?</h2>
        <div class="content has-text-justified">
          <p>
            CryoSPHERE takes the number of segments N used to cut the protein as a hyperparameter. During a forward pass, two steps happen concurrently:
           <ul>
              <li>An encoder maps the image to a distribution over a latent space. A latent variable is sampled and the decoder maps it to N rotations and N translations, that is, one rotation and translation per segment.</li>
              <li>The parameters a Gaussian mixture with N modes over the line supporting the residue indexes are used to compute the probability of each residue to belong to each segment.</li>
          </ul>
          Each residue position in the nominal structure is then rotated and translated according to the transformation of each segment, where these transformations are weighted by how much the residue belongs to each segment. This way, the transformation of the protein is locally rigid. The transformed nominal structure is then turned into a volume and projected into an image, that is compared to the true image. Finally, the backward pass is performed.
        </div>
        <div style="display: inline-block; vertical-align: middle; width: 50%;">
        <img src="static/images/VAEFlow3.png" alt="VAEFLOW"/>
          <h2 class="subtitle has-text-centered">
          Depiction of cryoSPHERE variational auto-encoding architecture.
        </h2>
      </div>
      </div>
    </div>
  </div>
</section>
<!-- End how does cryoSPHERE works ? -->


<!-- Results -->
<section class="section hero is-light">
  <div class="container is-max-desktop">
    <div class="columns is-centered has-text-centered">
      <div class="column is-four-fifths">
        <h2 class="title is-3"> Results </h2>
        <div class="content has-text-justified">
          <p>
            cryoSPHERE outputs, for each image:
           <ul>
              <li>A latent distribution associated with that image.</li>
              <li>The nominal structure deformed to match that image.</li>
              <li>The segmentation of the protein. This segmentation is shared accross all the images.</li>
          </ul>
      </div>
    </div>
  </div>
</section>
<!-- Results -->

<!-- Image carousel -->
<section class="hero is-small">
  <div class="hero-body">
    <div class="container">
      <div id="results-carousel" class="carousel results-carousel">
       <div class="item">
        <!-- Your image here -->
        <img src="static/images/phy_dataset.png" alt="MY ALT TEXT"/>
        <h2 class="subtitle has-text-centered">
          Results on a toy datasets: 10 000 structures were generated with molecular dynamics for molecule of 1006 residues. Out of these, 150 000 images were created. The leftmost structure is the nominal structure, generated by AlphaFold, with the segmentation recovered by cryoSPHERE. From middle right to rightmost: examples of predicted structures (in blue) with the corresponding ground truth structure (in green) for three images taken in the dataset.
        </h2>
      </div>
      <div class="item">
        <!-- Your image here -->
        <img src="static/images/empiar10180.png" alt="MY ALT TEXT"/>
        <h2 class="subtitle has-text-centered">
          CryoSPHERE results on EMPIAR-10180, a real dataset comprising 327 490 images of a precatalytic spliceosome with 13 941 residues, making it a computationally heavy dataset to tackle. We use the PDB: 5NRL as the nominal structure. After running cryoSPHERE, we perform a PCA decomposition of the latent space. The leftmost and middle left figures depict ten structures taken evenly along the first principal component (from red to blue) from two different angles. After running cryoSPHERE, we run DRGN-AI with cryoSPHERE's latent space to debias our results. Traversing the first principal component shows that the Sf3b domain gets incurvated down while the helicase move closer to the foot of the protein. This is in line with the literature. The motion of the protein also brings the alpha helix of the Spp381 domain closer to the foot, as corroborated by the existing literature. Comparison between the recovered structures and volumes shows similar movements, indicating a small amount of bias from the structural constraints. In addition, the absence of density corresponding to the U2 domain in the volume indicates that it there is compositional heterogeneity that cryoSPHERE could not detect.
        </h2>
      </div>
  </div>
</div>
</div>
</section>
<!-- End image carousel -->



<!-- Youtube video -->
<section class="hero is-small is-light">
  <div class="hero-body">
    <div class="container">
      <!-- Paper video. -->
      <div class="columns is-centered has-text-centered">
        <div class="column is-four-fifths">
          
          <div class="publication-video">
            <!-- Youtube embed code here -->
            <iframe src="https://www.youtube.com/embed/nhgQU6cEPwI" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe>
            <h2 class="title is-3">Motion recovered by cryoSPHERE on EMPIAR10180.</h2>
          </div>
        </div>
      </div>
    </div>
  </div>
</section>
<!-- End youtube video -->


<!-- Paper poster -->
<section class="hero is-small is-light">
  <div class="hero-body">
    <div class="container">
      <h2 class="title">Poster</h2>

      <iframe  src="static/pdfs/GenLifePoster.pdf" width="100%" height="550">
          </iframe>
        
      </div>
    </div>
  </section>
<!--End paper poster -->


<!--BibTex citation -->
  <section class="section" id="BibTeX">
    <div class="container is-max-desktop content">
      <h2 class="title">BibTeX</h2>
      <pre><code>BibTex Code Here</code></pre>
    </div>
</section>
<!--End BibTex citation -->


  <footer class="footer">
  <div class="container">
    <div class="columns is-centered">
      <div class="column is-8">
        <div class="content">

          <p>
            This page was built using the <a href="https://github.com/eliahuhorwitz/Academic-project-page-template" target="_blank">Academic Project Page Template</a> which was adopted from the <a href="https://nerfies.github.io" target="_blank">Nerfies</a> project page.
            You are free to borrow the source code of this website, we just ask that you link back to this page in the footer. <br> This website is licensed under a <a rel="license"  href="http://creativecommons.org/licenses/by-sa/4.0/" target="_blank">Creative
            Commons Attribution-ShareAlike 4.0 International License</a>.
          </p>

        </div>
      </div>
    </div>
  </div>
</footer>

<!-- Statcounter tracking code -->
  
<!-- You can add a tracker to track page visits by creating an account at statcounter.com -->

    <!-- End of Statcounter Code -->

  </body>
  </html>
